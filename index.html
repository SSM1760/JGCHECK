

<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ì–´ë¦°ì´ì§‘Â·ìœ ì¹˜ì› ìœ„ìƒÂ·ì•ˆì „ ìì²´ì ê²€ ì²´í¬ë¦¬ìŠ¤íŠ¸</title>

  <style>
    :root {
      --bg: #f6f7fb;
      --card: #ffffff;
      --line: #e5e7eb;
      --text: #111827;
      --muted: #6b7280;
      --brand: #2563eb;
      --ok: #16a34a;
      --danger: #dc2626;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 20px;
      font-family: system-ui, -apple-system, "Noto Sans KR", "Apple SD Gothic Neo", sans-serif;
      background: var(--bg);
      color: var(--text);
    }

    .wrapper {
      max-width: 900px;
      margin: 0 auto;
      background: var(--card);
      border-radius: 12px;
      padding: 24px 24px 32px;
      box-shadow: 0 8px 20px rgba(15,23,42,0.08);
      border: 1px solid var(--line);
    }

    h1 {
      margin: 0 0 4px;
      font-size: 1.5rem;
      text-align: center;
    }

    .subtitle {
      text-align: center;
      font-size: 0.9rem;
      color: var(--muted);
      margin-bottom: 20px;
    }

    .info-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px 16px;
      margin-bottom: 16px;
      font-size: 0.9rem;
    }

    .info-row label {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .info-row input[type="text"],
    .info-row input[type="date"] {
      border: 1px solid var(--line);
      border-radius: 6px;
      padding: 4px 8px;
      font-size: 0.9rem;
    }

    .guide-box {
      border-radius: 10px;
      background: #eff6ff;
      border: 1px solid #bfdbfe;
      padding: 10px 12px;
      font-size: 0.85rem;
      color: #1d4ed8;
      margin-bottom: 20px;
      line-height: 1.4;
    }

    .checklist {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .item {
      border-radius: 10px;
      border: 1px solid var(--line);
      padding: 12px 12px 10px;
      background: #f9fafb;
    }

    .item-header {
      display: flex;
      gap: 8px;
      margin-bottom: 8px;
      align-items: flex-start;
    }

    .item-index {
      font-weight: 600;
      color: var(--brand);
      min-width: 20px;
    }

    .item-label {
      font-weight: 500;
    }

    .item-options {
      font-size: 0.9rem;
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-bottom: 6px;
    }

    .item-options label {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      cursor: pointer;
    }

    .item-options input[type="radio"] {
      accent-color: var(--brand);
    }

    .item-memo {
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 0.85rem;
    }

    .item-memo label { color: var(--muted); }

    .item-memo textarea {
      width: 100%;
      border-radius: 8px;
      border: 1px solid var(--line);
      padding: 6px 8px;
      resize: vertical;
      min-height: 48px;
      font-family: inherit;
      font-size: 0.85rem;
    }

    .item-ref-row {
      margin-top: 6px;
      display: flex;
      justify-content: flex-end;
    }

    .btn-ref {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid var(--brand);
      background: #eff6ff;
      color: var(--brand);
      font-size: 0.8rem;
      cursor: pointer;
      line-height: 1.2;
    }

    .btn-ref:hover {
      background: #dbeafe;
    }

    .actions {
      margin-top: 20px;
      display: flex;
      gap: 10px;
      justify-content: flex-end;
      align-items: center;
      font-size: 0.9rem;
    }

    .btn {
      border: none;
      border-radius: 999px;
      padding: 8px 16px;
      font-size: 0.9rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .btn-primary {
      background: var(--brand);
      color: #fff;
    }

    .btn-primary:disabled {
      opacity: 0.6;
      cursor: default;
    }

    .status {
      min-height: 1.2em;
      color: var(--muted);
    }

    .status.ok { color: var(--ok); }
    .status.err { color: var(--danger); }

    .footer-note {
      margin-top: 20px;
      padding-top: 12px;
      border-top: 1px dashed var(--line);
      font-size: 0.85rem;
      color: var(--muted);
      text-align: right;
    }

    @media (max-width: 600px) {
      .wrapper {
        padding: 16px 12px 24px;
      }
      .info-row {
        flex-direction: column;
        align-items: flex-start;
      }
    }

/* ===== ì„¼í„° ì „ì†¡ ì™„ë£Œ ëª¨ë‹¬ ===== */
.send-modal-backdrop {
  position: fixed;
  inset: 0;
  background: rgba(15, 23, 42, 0.45);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}

.send-modal {
  background: #ffffff;
  border-radius: 12px;
  padding: 16px 20px 14px;
  box-shadow: 0 18px 45px rgba(15,23,42,0.35);
  max-width: 360px;
  width: 90%;
  font-family: inherit;
}

.send-modal-title {
  font-size: 1rem;
  font-weight: 600;
  margin-bottom: 8px;
  color: #111827;
}

.send-modal-body {
  font-size: 0.9rem;
  color: #4b5563;
  line-height: 1.4;
  margin-bottom: 14px;
}

.send-modal-footer {
  display: flex;
  justify-content: flex-end;
}

.send-modal-btn {
  border: none;
  border-radius: 999px;
  padding: 6px 14px;
  font-size: 0.9rem;
  background: #2563eb;
  color: #ffffff;
  cursor: pointer;
}

.send-modal-btn:hover {
  background: #1d4ed8;
}

    /* ì°¸ê³ ìë£Œ ëª¨ë‹¬ */
    .ref-modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.55);
      display: none;               /* ê¸°ë³¸ì€ ìˆ¨ê¹€ */
      justify-content: center;
      align-items: center;
      z-index: 900;                /* sendModalë³´ë‹¤ ì•/ë’¤ë¡œ ì¡°ì ˆí•˜ê³  ì‹¶ìœ¼ë©´ ìˆ«ìë§Œ ì¡°ì • */
    }

    .ref-modal {
      background: #ffffff;
      border-radius: 12px;
      box-shadow: 0 18px 45px rgba(15, 23, 42, 0.35);
      padding: 10px 10px 14px;
      max-width: min(90vw, 210mm);   /* A4 ê°€ë¡œ(210mm)ë¥¼ ê¸°ì¤€ìœ¼ë¡œ */
      max-height: min(90vh, 297mm);  /* A4 ì„¸ë¡œ(297mm)ë¥¼ ê¸°ì¤€ìœ¼ë¡œ */
      display: flex;
      flex-direction: column;
      box-sizing: border-box;
    }

    .ref-modal-header {
      display: flex;
      justify-content: flex-end;
      margin-bottom: 4px;
    }

    .ref-modal-close {
      border: none;
      background: transparent;
      font-size: 1.4rem;
      line-height: 1;
      cursor: pointer;
      color: #6b7280;
    }

    .ref-modal-close:hover {
      color: #111827;
    }

.ref-modal-content {
  flex: 1;
  display: flex;
  justify-content: center;
  align-items: center;
  overflow: visible;   /* ë˜ëŠ” ì•„ì˜ˆ overflow ì¤„ ì‚­ì œ */
}

    .ref-modal-content img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;  /* A4 ë¹„ìœ¨ ì´ë¯¸ì§€ê°€ ì˜ë¦¬ì§€ ì•Šë„ë¡ */
      display: block;
    }

  </style>
</head>

<body>
  <div class="wrapper">
    <h1>ì–´ë¦°ì´ì§‘Â·ìœ ì¹˜ì› ìœ„ìƒÂ·ì•ˆì „ ìì²´ì ê²€ ì²´í¬ë¦¬ìŠ¤íŠ¸</h1>
    <div class="subtitle">â€» ê° í•­ëª©ë³„ë¡œ ì í•©Â·ë¶€ì í•©ì„ ì„ íƒí•˜ê³ , í•„ìš”í•œ ê²½ìš° ì•„ë˜ ë©”ëª¨ë€ì— ê°œì„ ì‚¬í•­ì„ ê¸°ë¡í•´ ì£¼ì„¸ìš”.</div>

    <!-- ê¸°ë³¸ ì •ë³´ -->
    <div class="info-row">
      <label>ê¸°ê´€ëª…
        <input type="text" id="orgName" placeholder="ì˜ˆ: â—‹â—‹ì–´ë¦°ì´ì§‘" />
      </label>
      <label>ì ê²€ì¼
        <input type="date" id="checkDate" />
      </label>
      <label>ì ê²€ì
        <input type="text" id="checker" placeholder="ì´ë¦„" />
      </label>
    </div>

    <div class="guide-box">
      âœ” â€œë¶€ì í•©â€ì„ ì„ íƒí•œ í•­ëª©ì€ ì•„ë˜ ë©”ëª¨ì¹¸ì— <strong>ê°œì„  ê³„íš(ë¬´ì—‡ì„, ì–¸ì œê¹Œì§€, ì–´ë–»ê²Œ)</strong>ë¥¼ ê°„ë‹¨íˆ ì ì–´ ì£¼ì„¸ìš”.<br>
      âœ” ì•„ë˜ <strong>â€œì„¼í„°ì— ì „ì†¡â€ ë²„íŠ¼</strong>ì„ ëˆ„ë¥´ë©´ ì ê²€ ê²°ê³¼ê°€ ì„¼í„° êµ¬ê¸€ì‹œíŠ¸ì— ìë™ ì €ì¥ë©ë‹ˆë‹¤.
    </div>

    <!-- ì²´í¬ë¦¬ìŠ¤íŠ¸ ì‹œì‘ -->
    <div class="checklist" id="checklistArea">

      <!-- 1ë²ˆ í•­ëª© -->
      <div class="item">
        <div class="item-header">
          <div class="item-index">1.</div>
          <div class="item-label">ì¡°ë¦¬ì‹¤Â·ë°°ì‹ì‹¤ ë°”ë‹¥, ë²½, ì‘ì—…ëŒ€ê°€ ì²­ê²°í•˜ê²Œ ìœ ì§€ë˜ê³  ìˆë‹¤.</div>
        </div>
        <div class="item-options">
          <label><input type="radio" name="item1" value="ì í•©"> ì í•©</label>
          <label><input type="radio" name="item1" value="ë¶€ì í•©"> ë¶€ì í•©</label>
        </div>

        <!-- ğŸ” ì°¸ê³ ìë£Œ ë²„íŠ¼ (1ë²ˆ ë¬¸í•­) -->
        <div class="item-ref-row">
          <button
            type="button"
            class="btn-ref"
            data-ref-img="./img/ref/ref1.png"
          >
            ì°¸ê³ ìë£Œ
          </button>
        </div>

        <div class="item-memo">
          <label for="memo1">ë©”ëª¨ / ê°œì„ ê³„íš</label>
          <textarea id="memo1" name="memo1" placeholder="ì˜ˆ: ë°°ì‹ì‹¤ ì¶œì…êµ¬ ì£¼ë³€ ì£¼ 1íšŒ ì¶”ê°€ ì²­ì†Œ ì˜ˆì •(â—‹ì›” â—‹ì¼ê¹Œì§€)."></textarea>
        </div>
      </div>

      <!-- 2ë²ˆ í•­ëª© -->
      <div class="item">
        <div class="item-header">
          <div class="item-index">2.</div>
          <div class="item-label">ëƒ‰ì¥Â·ëƒ‰ë™ê³ ì—ëŠ” ìœ í†µê¸°í•œì´ ê²½ê³¼í•œ ì‹ì¬ë£Œê°€ ì—†ìœ¼ë©°, ì‹ì¬ ë¼ë²¨(í’ˆëª…Â·ê°œë´‰ì¼Â·ìœ í†µê¸°í•œ)ì´ ë¶€ì°©ë˜ì–´ ìˆë‹¤.</div>
        </div>
        <div class="item-options">
          <label><input type="radio" name="item2" value="ì í•©"> ì í•©</label>
          <label><input type="radio" name="item2" value="ë¶€ì í•©"> ë¶€ì í•©</label>
        </div>

        <!-- ğŸ” ì°¸ê³ ìë£Œ ë²„íŠ¼ (2ë²ˆ ë¬¸í•­) -->
        <div class="item-ref-row">
          <button
            type="button"
            class="btn-ref"
            data-ref-img="./img/ref/ref2.png"
          >
            ì°¸ê³ ìë£Œ
          </button>
        </div>

        <div class="item-memo">
          <label for="memo2">ë©”ëª¨ / ê°œì„ ê³„íš</label>
          <textarea id="memo2" name="memo2" placeholder="ì˜ˆ: ì¼ë¶€ ëƒ‰ì¥ ì‹ì¬ ë¼ë²¨ ëˆ„ë½ â†’ ì „ë‹´ì ì§€ì •, ë§¤ì£¼ ì›”ìš”ì¼ ì ê²€."></textarea>
        </div>
      </div>

      <!-- 3ë²ˆ í•­ëª© -->
      <div class="item">
        <div class="item-header">
          <div class="item-index">3.</div>
          <div class="item-label">ì¡°ë¦¬ì¢…ì‚¬ìëŠ” ì¡°ë¦¬ ì‹œ ì•ì¹˜ë§ˆÂ·ëª¨ì ë“± ìœ„ìƒë³µì„ ì°©ìš©í•˜ê³ , ì† ì”»ê¸°Â·ì† ì†Œë…ì„ ì¶©ë¶„íˆ ì‹œí–‰í•˜ê³  ìˆë‹¤.</div>
        </div>
        <div class="item-options">
          <label><input type="radio" name="item3" value="ì í•©"> ì í•©</label>
          <label><input type="radio" name="item3" value="ë¶€ì í•©"> ë¶€ì í•©</label>
        </div>

        <!-- ğŸ” ì°¸ê³ ìë£Œ ë²„íŠ¼ (3ë²ˆ ë¬¸í•­) -->
        <div class="item-ref-row">
          <button
            type="button"
            class="btn-ref"
            data-ref-img="./img/ref/ref3.png"
          >
            ì°¸ê³ ìë£Œ
          </button>
        </div>

        <div class="item-memo">
          <label for="memo3">ë©”ëª¨ / ê°œì„ ê³„íš</label>
          <textarea id="memo3" name="memo3" placeholder="ì˜ˆ: ì† ì”»ê¸° êµìœ¡ìë£Œ ê²Œì‹œ, ì›” 1íšŒ ì‹¤ìŠµêµìœ¡ ì‹¤ì‹œ ê³„íš."></textarea>
        </div>
      </div>

      <!-- 4ë²ˆ í•­ëª© -->
      <div class="item">
        <div class="item-header">
          <div class="item-index">4.</div>
          <div class="item-label">ë„ë§ˆÂ·ì¹¼ ë“± ì¡°ë¦¬ë„êµ¬ëŠ” ìš©ë„ë³„(ìœ¡ë¥˜Â·ì–´ë¥˜Â·ì±„ì†Œ ë“±)ë¡œ êµ¬ë¶„í•˜ì—¬ ì‚¬ìš©Â·ë³´ê´€í•˜ê³  ìˆë‹¤.</div>
        </div>
        <div class="item-options">
          <label><input type="radio" name="item4" value="ì í•©"> ì í•©</label>
          <label><input type="radio" name="item4" value="ë¶€ì í•©"> ë¶€ì í•©</label>
        </div>

        <!-- ğŸ” ì°¸ê³ ìë£Œ ë²„íŠ¼ (4ë²ˆ ë¬¸í•­) -->
        <div class="item-ref-row">
          <button
            type="button"
            class="btn-ref"
            data-ref-img="./img/ref/ref4.png"
          >
            ì°¸ê³ ìë£Œ
          </button>
        </div>

        <div class="item-memo">
          <label for="memo4">ë©”ëª¨ / ê°œì„ ê³„íš</label>
          <textarea id="memo4" name="memo4" placeholder="ì˜ˆ: ìƒ‰ê¹”ë³„ ë„ë§ˆ í‘œì‹œ í…Œì´í”„ êµì²´, êµ¬ë¶„í‘œ ë¶€ì°© ì˜ˆì •."></textarea>
        </div>
      </div>

      <!-- 5ë²ˆ í•­ëª© -->
      <div class="item">
        <div class="item-header">
          <div class="item-index">5.</div>
          <div class="item-label">ë³´ì¡´ì‹ì€ ê·œì •ì— ë”°ë¼ ì •í•´ì§„ ì–‘ê³¼ ë°©ë²•ìœ¼ë¡œ ì±„ì·¨Â·ë³´ê´€í•˜ê³ , ë³´ê´€ê¸°ê°„ ê²½ê³¼ë¶„ì€ ì¦‰ì‹œ íê¸°í•˜ê³  ìˆë‹¤.</div>
        </div>
        <div class="item-options">
          <label><input type="radio" name="item5" value="ì í•©"> ì í•©</label>
          <label><input type="radio" name="item5" value="ë¶€ì í•©"> ë¶€ì í•©</label>
        </div>

        <!-- ğŸ” ì°¸ê³ ìë£Œ ë²„íŠ¼ (5ë²ˆ ë¬¸í•­) -->
        <div class="item-ref-row">
          <button
            type="button"
            class="btn-ref"
            data-ref-img="./img/ref/ref5.png"
          >
            ì°¸ê³ ìë£Œ
          </button>
        </div>

        <div class="item-memo">
          <label for="memo5">ë©”ëª¨ / ê°œì„ ê³„íš</label>
          <textarea id="memo5" name="memo5" placeholder="ì˜ˆ: ë³´ì¡´ì‹ ìš©ê¸° ë¶€ì¡± â†’ ì¶”ê°€ êµ¬ì… í›„ ë‚ ì§œ ë¼ë²¨ ì¼ê´„ ë¶€ì°© ê³„íš."></textarea>
        </div>
      </div>

      <!-- 6ë²ˆ í•­ëª© -->
      <div class="item">
        <div class="item-header">
          <div class="item-index">6.</div>
          <div class="item-label">ì•Œë ˆë¥´ê¸° ìœ ë°œ ì‹ì¬ë£Œ ì œê³µ ì‹œ ëŒ€ìƒ ì•„ë™ì„ í™•ì¸í•˜ê³ , ëŒ€ì²´ì‹ ì œê³µ ë˜ëŠ” ë³´í˜¸ì ì•ˆë‚´ ë“± ê´€ë¦¬ê°€ ì´ë£¨ì–´ì§€ê³  ìˆë‹¤.</div>
        </div>
        <div class="item-options">
          <label><input type="radio" name="item6" value="ì í•©"> ì í•©</label>
          <label><input type="radio" name="item6" value="ë¶€ì í•©"> ë¶€ì í•©</label>
        </div>

        <!-- ğŸ” ì°¸ê³ ìë£Œ ë²„íŠ¼ (6ë²ˆ ë¬¸í•­) -->
        <div class="item-ref-row">
          <button
            type="button"
            class="btn-ref"
            data-ref-img="./img/ref/ref6.png"
          >
            ì°¸ê³ ìë£Œ
          </button>
        </div>

        <div class="item-memo">
          <label for="memo6">ë©”ëª¨ / ê°œì„ ê³„íš</label>
          <textarea id="memo6" name="memo6" placeholder="ì˜ˆ: ì•Œë ˆë¥´ê¸° ëª…ë‹¨ ì£¼ê¸°ì  ì—…ë°ì´íŠ¸, êµì‚¬ êµìœ¡ ê°•í™” ì˜ˆì •."></textarea>
        </div>
      </div>

      <!-- 7ë²ˆ í•­ëª© -->
      <div class="item">
        <div class="item-header">
          <div class="item-index">7.</div>
          <div class="item-label">ë°°ì‹ëŒ€Â·ì‹íŒÂ·ìˆ˜ì € ë“±ì€ ì„¸ì²™Â·ì†Œë… í›„ ì²­ê²°í•˜ê²Œ ë³´ê´€ë˜ë©°, ê¸‰ì‹ ì œê³µ ì „ ìƒíƒœë¥¼ í™•ì¸í•˜ê³  ìˆë‹¤.</div>
        </div>
        <div class="item-options">
          <label><input type="radio" name="item7" value="ì í•©"> ì í•©</label>
          <label><input type="radio" name="item7" value="ë¶€ì í•©"> ë¶€ì í•©</label>
        </div>

        <!-- ğŸ” ì°¸ê³ ìë£Œ ë²„íŠ¼ (7ë²ˆ ë¬¸í•­) -->
        <div class="item-ref-row">
          <button
            type="button"
            class="btn-ref"
            data-ref-img="./img/ref/ref7.png"
          >
            ì°¸ê³ ìë£Œ
          </button>
        </div>

        <div class="item-memo">
          <label for="memo7">ë©”ëª¨ / ê°œì„ ê³„íš</label>
          <textarea id="memo7" name="memo7" placeholder="ì˜ˆ: ê±´ì¡°ëŒ€ ì •ë¦¬, ì†Œë…ê¸° ì‚¬ìš©ì ê²€ ì£¼ 1íšŒ ê¸°ë¡ ê³„íš."></textarea>
        </div>
      </div>

      <!-- 8ë²ˆ í•­ëª© -->
      <div class="item">
        <div class="item-header">
          <div class="item-index">8.</div>
          <div class="item-label">ê¸°íƒ€ ìš°ë¦¬ ê¸°ê´€ì—ì„œ ì¤‘ì ì ìœ¼ë¡œ ê´€ë¦¬í•˜ê³ ì í•˜ëŠ” ìœ„ìƒÂ·ì•ˆì „ í•­ëª©.</div>
        </div>
        <div class="item-options">
          <label><input type="radio" name="item8" value="ì í•©"> ì í•©</label>
          <label><input type="radio" name="item8" value="ë¶€ì í•©"> ë¶€ì í•©</label>
        </div>

        <!-- ğŸ” ì°¸ê³ ìë£Œ ë²„íŠ¼ (8ë²ˆ ë¬¸í•­) -->
        <div class="item-ref-row">
          <button
            type="button"
            class="btn-ref"
            data-ref-img="./img/ref/ref8.png"
          >
            ì°¸ê³ ìë£Œ
          </button>
        </div>

        <div class="item-memo">
          <label for="memo8">ë©”ëª¨ / ê°œì„ ê³„íš</label>
          <textarea id="memo8" name="memo8" placeholder="ê¸°ê´€ ìƒí™©ì— ë§ëŠ” ì¤‘ì  ê´€ë¦¬ ë‚´ìš©ì„ ììœ ë¡­ê²Œ ê¸°ë¡í•˜ì„¸ìš”."></textarea>
        </div>
      </div>

    </div>
    <!-- ì²´í¬ë¦¬ìŠ¤íŠ¸ ë -->

    <div class="actions">
      <div id="status" class="status"></div>
      <button type="button" id="btnSend" class="btn btn-primary">
        ì„¼í„°ì— ì „ì†¡
      </button>
    </div>

    <div class="footer-note">
      ë°”ì˜ì‹  ì¤‘ì—ë„ ì•ˆì „í•˜ê³  ìœ„ìƒì ì¸ ê¸‰ì‹ ì œê³µì„ ìœ„í•´ ì• ì“°ì‹œëŠ” ëª¨ë“  ì„ ìƒë‹˜ë“¤ê»˜ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤.
    </div>
  </div>

  <script>
    // â˜…â˜…â˜… ì—¬ê¸°ì— ì‹¤ì œ ë°œê¸‰í•œ Apps Script ì›¹ì•± URLì„ ë„£ìœ¼ì„¸ìš” â˜…â˜…â˜…
    const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbw4HrXC-wTQDLR7ZQm0cv41g-gQwrxNDkIF_SkzlAzXnzVVstG4xhXe9rDwcagWPpkDww/exec';

    const N_ITEMS = 8; // í•­ëª© ê°œìˆ˜

    function collectFormData() {
      const orgName   = document.getElementById('orgName').value.trim();
      const checkDate = document.getElementById('checkDate').value;
      const checker   = document.getElementById('checker').value.trim();

      const payload = {
        mode: 'save',
        orgName,
        checkDate,
        checker
      };

      for (let i = 1; i <= N_ITEMS; i++) {
        const radios = document.querySelectorAll(`input[name="item${i}"]`);
        let value = '';
        radios.forEach(r => { if (r.checked) value = r.value; });
        const memo = document.getElementById(`memo${i}`)?.value || '';

        payload[`item${i}`] = value;
        payload[`memo${i}`] = memo;
      }

      return payload;
    }

function openSendModal() {
  const modal = document.getElementById('sendModal');
  if (modal) {
    modal.style.display = 'flex';
  }
}

function closeSendModal() {
  const modal = document.getElementById('sendModal');
  if (modal) {
    modal.style.display = 'none';
  }
}

function sendToCenter() {
  const statusEl = document.getElementById('status');
  const btn = document.getElementById('btnSend');

  const data = collectFormData();

  if (!data.orgName || !data.checkDate) {
    statusEl.textContent = 'ê¸°ê´€ëª…ê³¼ ì ê²€ì¼ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.';
    statusEl.className = 'status err';
    return;
  }

  statusEl.textContent = 'ì„¼í„°ë¡œ ì „ì†¡ ì¤‘ì…ë‹ˆë‹¤...';
  statusEl.className = 'status';
  btn.disabled = true;

  const body = new URLSearchParams(data).toString();

  fetch(WEB_APP_URL, {
    method: 'POST',
    mode: 'no-cors',                  // â† ì´ ëª¨ë“œë©´ ì‘ë‹µì€ ëª» ì½ì§€ë§Œ, ìš”ì²­ì€ ë‚ ì•„ê°„ë‹¤
    headers: {
      'Content-Type': 'application/x-www-form-urlencoded'
    },
    body
  }).then(() => {
    statusEl.textContent = 'ì „ì†¡ ìš”ì²­ì„ ë³´ëƒˆìŠµë‹ˆë‹¤. ì¸í„°ë„·ì´ ì •ìƒì´ë¼ë©´ ì„¼í„° ì‹œíŠ¸ì— ì €ì¥ë©ë‹ˆë‹¤.';
    statusEl.className = 'status ok';

    openSendModal();   // âœ… ì „ì†¡ í›„ ëª¨ë‹¬ ì—´ê¸°
  }).catch(err => {
    console.error(err);
    statusEl.textContent = 'ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì¸í„°ë„· ì—°ê²° ìƒíƒœë¥¼ í™•ì¸í•´ ì£¼ì„¸ìš”.';
    statusEl.className = 'status err';
  }).finally(() => {
    btn.disabled = false;
  });
}

    document.getElementById('btnSend').addEventListener('click', sendToCenter);

// ëª¨ë‹¬ í™•ì¸ ë²„íŠ¼ / ë°”ê¹¥ í´ë¦­ìœ¼ë¡œ ë‹«ê¸°
window.addEventListener('DOMContentLoaded', () => {
  const okBtn = document.getElementById('sendModalOk');
  const modal = document.getElementById('sendModal');

  if (okBtn) {
    okBtn.addEventListener('click', closeSendModal);
  }
  if (modal) {
    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        closeSendModal();
      }
    });
  }
});

// âœ… ì°¸ê³ ìë£Œ ëª¨ë‹¬ ì—´ê¸°/ë‹«ê¸°
window.addEventListener('DOMContentLoaded', () => {
  const refModal    = document.getElementById('refModal');
  const refImg      = document.getElementById('refModalImg');
  const refCloseBtn = document.getElementById('refModalClose');
  const refButtons  = document.querySelectorAll('.btn-ref');

  if (!refModal || !refImg) return;

  const openRefModal = (imgUrl) => {
    if (!imgUrl) return;
    refImg.src = imgUrl;
    refModal.style.display = 'flex';
    document.body.style.overflow = 'hidden';  // ë°°ê²½ ìŠ¤í¬ë¡¤ ì ê¸ˆ
  };

  const closeRefModal = () => {
    refModal.style.display = 'none';
    refImg.src = '';
    document.body.style.overflow = '';        // ìŠ¤í¬ë¡¤ ë³µì›
  };

  // ê° "ì°¸ê³ ìë£Œ" ë²„íŠ¼ í´ë¦­ â†’ ëª¨ë‹¬ ì—´ê¸°
  refButtons.forEach((btn) => {
    btn.addEventListener('click', () => {
      const imgUrl = btn.getAttribute('data-ref-img');
      openRefModal(imgUrl);
    });
  });

  // ë‹«ê¸° ë²„íŠ¼
  if (refCloseBtn) {
    refCloseBtn.addEventListener('click', closeRefModal);
  }

  // ë°°ê²½ í´ë¦­ ì‹œ ë‹«ê¸°
  refModal.addEventListener('click', (e) => {
    if (e.target === refModal) {
      closeRefModal();
    }
  });

  // ESC í‚¤ë¡œ ë‹«ê¸°
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && refModal.style.display === 'flex') {
      closeRefModal();
    }
  });
});

  </script>

  <!-- ğŸ” ì°¸ê³ ìë£Œ ëª¨ë‹¬ -->
  <div id="refModal" class="ref-modal-backdrop">
    <div class="ref-modal" role="dialog" aria-modal="true" aria-label="ì°¸ê³ ìë£Œ">
      <div class="ref-modal-header">
        <button type="button" id="refModalClose" class="ref-modal-close" aria-label="ë‹«ê¸°">
          Ã—
        </button>
      </div>
      <div class="ref-modal-content">
        <img id="refModalImg" src="" alt="ì°¸ê³ ìë£Œ ì´ë¯¸ì§€" />
      </div>
    </div>
  </div>

<!-- ì„¼í„° ì „ì†¡ ì™„ë£Œ ëª¨ë‹¬ -->
<div id="sendModal" class="send-modal-backdrop" style="display:none;">
  <div class="send-modal">
    <div class="send-modal-title">ì„¼í„° ì „ì†¡ ì™„ë£Œ</div>
    <div class="send-modal-body">
      ì €ì¥ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.
    </div>
    <div class="send-modal-footer">
      <button type="button" id="sendModalOk" class="send-modal-btn">í™•ì¸</button>
    </div>
  </div>
</div>

</body>
</html>

